<roblox xmlns:xmime="http://www.w3.org/2005/05/xmlmime" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xsi:noNamespaceSchemaLocation="http://www.roblox.com/roblox.xsd" version="4">
	<External>null</External>
	<External>nil</External>
	<Item class="Tool" referent="RBX4C891B1E4DCB4440801306DCF8B6BAA4">
		<Properties>
			<bool name="CanBeDropped">true</bool>
			<bool name="Enabled">true</bool>
			<CoordinateFrame name="Grip">
				<X>0</X>
				<Y>0</Y>
				<Z>-1.75</Z>
				<R00>0</R00>
				<R01>0</R01>
				<R02>1</R02>
				<R10>1</R10>
				<R11>0</R11>
				<R12>0</R12>
				<R20>0</R20>
				<R21>1</R21>
				<R22>0</R22>
			</CoordinateFrame>
			<bool name="ManualActivationOnly">false</bool>
			<string name="Name">Windforce</string>
			<Content name="TextureId"><url>http://www.roblox.com/asset/?id=77330254</url></Content>
			<string name="ToolTip">Windforce</string>
		</Properties>
		<Item class="Part" referent="RBX2C00819526F24BAEAA17FC36DDA0111B">
			<Properties>
				<bool name="Anchored">false</bool>
				<float name="BackParamA">-0.5</float>
				<float name="BackParamB">0.5</float>
				<token name="BackSurface">0</token>
				<token name="BackSurfaceInput">0</token>
				<float name="BottomParamA">-0.5</float>
				<float name="BottomParamB">0.5</float>
				<token name="BottomSurface">0</token>
				<token name="BottomSurfaceInput">0</token>
				<int name="BrickColor">102</int>
				<CoordinateFrame name="CFrame">
					<X>-1.61426783e-009</X>
					<Y>2</Y>
					<Z>2.56459884e-008</Z>
					<R00>-0.210324287</R00>
					<R01>-0.799929321</R01>
					<R02>0.562029064</R02>
					<R10>0.770393372</R10>
					<R11>0.218315244</R11>
					<R12>0.599025726</R12>
					<R20>-0.601877987</R20>
					<R21>0.558972538</R21>
					<R22>0.570343614</R22>
				</CoordinateFrame>
				<bool name="CanCollide">false</bool>
				<float name="Elasticity">0.5</float>
				<float name="Friction">0.300000012</float>
				<float name="FrontParamA">-0.5</float>
				<float name="FrontParamB">0.5</float>
				<token name="FrontSurface">0</token>
				<token name="FrontSurfaceInput">0</token>
				<float name="LeftParamA">-0.5</float>
				<float name="LeftParamB">0.5</float>
				<token name="LeftSurface">0</token>
				<token name="LeftSurfaceInput">0</token>
				<bool name="Locked">false</bool>
				<token name="Material">272</token>
				<string name="Name">Handle</string>
				<float name="Reflectance">0.300000012</float>
				<float name="RightParamA">-0.5</float>
				<float name="RightParamB">0.5</float>
				<token name="RightSurface">0</token>
				<token name="RightSurfaceInput">0</token>
				<Vector3 name="RotVelocity">
					<X>0</X>
					<Y>0</Y>
					<Z>0</Z>
				</Vector3>
				<float name="TopParamA">-0.5</float>
				<float name="TopParamB">0.5</float>
				<token name="TopSurface">0</token>
				<token name="TopSurfaceInput">0</token>
				<float name="Transparency">0</float>
				<Vector3 name="Velocity">
					<X>0</X>
					<Y>0</Y>
					<Z>0</Z>
				</Vector3>
				<token name="formFactorRaw">2</token>
				<token name="shape">1</token>
				<Vector3 name="size">
					<X>1</X>
					<Y>0.800000012</Y>
					<Z>5</Z>
				</Vector3>
			</Properties>
			<Item class="SpecialMesh" referent="RBXEDC55E192B4443B49AA8B04C7953EF21">
				<Properties>
					<token name="LODX">2</token>
					<token name="LODY">2</token>
					<Content name="MeshId"><url>rbxasset://fonts/sword.mesh</url></Content>
					<token name="MeshType">5</token>
					<string name="Name">Mesh</string>
					<Vector3 name="Offset">
						<X>0</X>
						<Y>0</Y>
						<Z>0</Z>
					</Vector3>
					<Vector3 name="Scale">
						<X>1.20000005</X>
						<Y>1.20000005</Y>
						<Z>1.20000005</Z>
					</Vector3>
					<Content name="TextureId"><null></null></Content>
					<Vector3 name="VertexColor">
						<X>1</X>
						<Y>1</Y>
						<Z>0</Z>
					</Vector3>
				</Properties>
			</Item>
			<Item class="Sound" referent="RBX6600B49145914810A51E7EB39993C83F">
				<Properties>
					<bool name="Looped">false</bool>
					<string name="Name">LungeSound</string>
					<float name="Pitch">1</float>
					<bool name="PlayOnRemove">false</bool>
					<Content name="SoundId"><url>rbxasset://sounds/swordlunge.wav</url></Content>
					<float name="Volume">0.600000024</float>
				</Properties>
			</Item>
			<Item class="Sound" referent="RBX677D364D07984B2EA2B68A7EFF8EE662">
				<Properties>
					<bool name="Looped">false</bool>
					<string name="Name">SlashSound</string>
					<float name="Pitch">1</float>
					<bool name="PlayOnRemove">false</bool>
					<Content name="SoundId"><url>rbxasset://sounds/swordslash.wav</url></Content>
					<float name="Volume">0.699999988</float>
				</Properties>
			</Item>
			<Item class="Sound" referent="RBX87DDE462289E4E6B81887FAF0F389C81">
				<Properties>
					<bool name="Looped">false</bool>
					<string name="Name">UnsheathSound</string>
					<float name="Pitch">1</float>
					<bool name="PlayOnRemove">false</bool>
					<Content name="SoundId"><url>rbxasset://sounds/unsheath.wav</url></Content>
					<float name="Volume">1</float>
				</Properties>
			</Item>
		</Item>
		<Item class="Script" referent="RBX35710628110F4E51B5BCB1E8D9EB018C">
			<Properties>
				<bool name="Disabled">false</bool>
				<Content name="LinkedSource"><null></null></Content>
				<string name="Name">Script</string>
				<ProtectedString name="Source"><![CDATA[--[[
	Rewritten by ArceusInator
	- Completely rewrote the sword
	- Added a Configurations folder so damage settings can be easily modified
	- The sword runs on the client in non-FE to reduce the impression of input delay
	- Fixed the floaty lunge issue
	
	This script will run the sword code on the server if filtering is enabled
--]]
local Tool = script.Parent
local GLib = require(206209239)
local GLibScript = GLib.Script
GLibScript.Name = 'GLib'
GLibScript.Parent = Tool
local Sword = require(Tool:WaitForChild'Sword')

if workspace.FilteringEnabled then
	-- Run the sword code on the server and accept input from the client
	
	Sword:Initialize()
	
	Tool:WaitForChild'RemoteClick'.OnServerEvent:connect(function(client, action)
		if client.Character == Tool.Parent then
			Sword:Attack()
		end
	end)
end]]></ProtectedString>
			</Properties>
		</Item>
		<Item class="LocalScript" referent="RBX78868F15F1AB40E59728E31A3FD634D7">
			<Properties>
				<bool name="Disabled">false</bool>
				<Content name="LinkedSource"><null></null></Content>
				<string name="Name">LocalScript</string>
				<ProtectedString name="Source"><![CDATA[--[[
	Rewritten by ArceusInator
	
	This script will run the sword code on the client if filtering is disabled
--]]
local Tool = script.Parent
local Sword = require(Tool:WaitForChild'Sword')

if not workspace.FilteringEnabled then
	-- Run the sword code on the client
	
	Sword:Initialize()
end

Tool.Equipped:connect(function(mouse)
	mouse.Button1Down:connect(function()
		if workspace.FilteringEnabled then
			-- Send input info to the server
			Tool.RemoteClick:FireServer()
		else
			-- Interpret it on the client
			Sword:Attack()
		end
	end)
end)]]></ProtectedString>
			</Properties>
		</Item>
		<Item class="RemoteEvent" referent="RBX4653E9AAD88B41CAAC8457A32F1AA227">
			<Properties>
				<string name="Name">RemoteClick</string>
			</Properties>
		</Item>
		<Item class="ModuleScript" referent="RBX78301390906E48D28583471D88967B24">
			<Properties>
				<Content name="LinkedSource"><null></null></Content>
				<string name="Name">Sword</string>
				<ProtectedString name="Source"><![CDATA[--[[
	Rewritten by ArceusInator
	
	This script is the Sword module.  This runs on either the server (when FilteringEnabled is on) or the client (when FilteringEnabled is off)
--]]
local Tool = script.Parent
local Handle = Tool.Handle
local Config = Tool:WaitForChild'Configurations'
local Sword = {
	-- Advanced settings
	DoubleClickMaxTime = 0.2,
	
	-- Variables
	State = 'Idle', -- Idle, Slashing, Lunging
	SlashingStartedAt = 0,
	AttackTicket = 0,
}

local GLib = require(Tool:WaitForChild'GLib') -- Library of useful functions
local Debris = game:GetService'Debris'

--
--
function Sword:Force(direction, part)
	if not GLib.IsProtected(part) and not part:FindFirstChild'Windforce_WindEffect' then
		local velocity = GLib.Create'BodyVelocity'{
			Name = 'Windforce_WindEffect',
			maxForce = Vector3.new(1,1,1)*1e7,
			P = 125,
			velocity = direction*150 + Vector3.new(0, 30, 0),
			Parent = part
		}
		Debris:AddItem(velocity, 0.25)
	end
end

function Sword:ForceCharacter(part)
	local character = GLib.GetCharacter(part)
	
	if character then
		local root = character:FindFirstChild'HumanoidRootPart' or character:FindFirstChild'Torso'
		
		if root and root:IsA'BasePart' then
			local myCharacter = GLib.GetCharacter(Tool)
			
			if myCharacter then
				local myRoot = myCharacter:FindFirstChild'HumanoidRootPart' or myCharacter:FindFirstChild'Torso'
				
				if myRoot and myRoot:IsA'BasePart' and myRoot.Position~=root.Position then
					local direction = (root.Position - myRoot.Position).unit
					Sword:Force(direction, root)
				end
			end
		end
	end
end

function Sword:Connect()
	Handle.Touched:connect(function(hit)
		local myPlayer = GLib.GetPlayerFromPart(Tool)
		local character, player, humanoid = GLib.GetCharacterFromPart(hit)
		
		if myPlayer~=nil and character~=nil and humanoid~=nil and myPlayer~=player then
			local isTeammate = GLib.IsTeammate(myPlayer, player)
			local myCharacter = myPlayer.Character
			local myHumanoid = myCharacter and myCharacter:FindFirstChild'Humanoid'
			
			if (Config.CanTeamkill.Value==true or isTeammate~=true) and (myHumanoid and myHumanoid:IsA'Humanoid' and myHumanoid.Health > 0) and (Config.CanKillWithForceField.Value or myCharacter:FindFirstChild'ForceField'==nil) then
				local doDamage = Config.IdleDamage.Value
				if Sword.State == 'Slashing' then
					doDamage = Config.SlashDamage.Value
				elseif Sword.State == 'Lunging' then
					doDamage = Config.LungeDamage.Value
				end
				
				GLib.TagHumanoid(humanoid, myPlayer, 1)
				humanoid:TakeDamage(doDamage)
				Sword:ForceCharacter(humanoid)
			end
		end
	end)
end

function Sword:Attack()
	local myCharacter, myPlayer, myHumanoid = GLib.GetCharacterFromPart(Tool)
	
	if myHumanoid~=nil and myHumanoid.Health > 0 then
		if Config.CanKillWithForceField.Value or myCharacter:FindFirstChild'ForceField'==nil then
			local now = tick()
			
			if Sword.State == 'Slashing' and now-Sword.SlashingStartedAt < Sword.DoubleClickMaxTime then
				Sword.AttackTicket = Sword.AttackTicket+1
				
				Sword:Lunge(Sword.AttackTicket)
			elseif Sword.State == 'Idle' then
				Sword.AttackTicket = Sword.AttackTicket+1
				Sword.SlashingStartedAt = now
				
				Sword:Slash(Sword.AttackTicket)
			end
		end
	end
end

function Sword:Slash(ticket)
	Sword.State = 'Slashing'
	
	Handle.SlashSound:Play()
	Sword:Animate'Slash'
	
	wait(0.5)
	
	if Sword.AttackTicket == ticket then
		Sword.State = 'Idle'
	end
end

function Sword:Lunge(ticket)
	Sword.State = 'Lunging'
	
	Handle.LungeSound:Play()
	Sword:Animate'Lunge'
	
	local force = Instance.new'BodyVelocity'
	force.velocity = Vector3.new(0, 10, 0)
	force.maxForce = Vector3.new(0, 4000, 0)
	force.Parent = Tool.Parent.Torso
	
	wait(0.25)
	Tool.Grip = CFrame.new(0, 0, -1.5, 0, -1, -0, -1, 0, -0, 0, 0, -1)
	wait(0.25)
	force:Destroy()
	wait(0.5)
	Tool.Grip = CFrame.new(0, 0, -1.5, 0, 0, 1, 1, 0, 0, 0, 1, 0)
	
	Sword.State = 'Idle'
end

function Sword:Animate(name)
	local tag = Instance.new'StringValue'
	tag.Name = 'toolanim'
	tag.Value = name
	tag.Parent = Tool -- Tag gets removed by the animation script
end

--
function Sword:Initialize()
	Sword:Connect()
end

--
--
return Sword]]></ProtectedString>
			</Properties>
		</Item>
		<Item class="Configuration" referent="RBX2E2902335F1C44B3859126C8EC8AD4C7">
			<Properties>
				<string name="Name">Configurations</string>
			</Properties>
			<Item class="BoolValue" referent="RBXEB33B71B67924C82A2173FAF74E6AAC3">
				<Properties>
					<string name="Name">CanTeamkill</string>
					<bool name="Value">false</bool>
				</Properties>
			</Item>
			<Item class="IntValue" referent="RBX5543E6114FBD4E8B80B793565B88D65E">
				<Properties>
					<string name="Name">IdleDamage</string>
					<int name="Value">10</int>
				</Properties>
			</Item>
			<Item class="IntValue" referent="RBX85DEF3269B5D4467B5FE2B7C377126C8">
				<Properties>
					<string name="Name">SlashDamage</string>
					<int name="Value">18</int>
				</Properties>
			</Item>
			<Item class="IntValue" referent="RBX6EFD25061F4046ECA8FA7494D65DE7DE">
				<Properties>
					<string name="Name">LungeDamage</string>
					<int name="Value">36</int>
				</Properties>
			</Item>
			<Item class="BoolValue" referent="RBX60F32B96ED244AC0ADC62A161696290C">
				<Properties>
					<string name="Name">CanKillWithForceField</string>
					<bool name="Value">true</bool>
				</Properties>
			</Item>
		</Item>
		<Item class="Camera" referent="RBXED909500E1B94C99959756ED3BC0DD44">
			<Properties>
				<Ref name="CameraSubject">null</Ref>
				<token name="CameraType">0</token>
				<CoordinateFrame name="CoordinateFrame">
					<X>-21.4168625</X>
					<Y>6.97274971</Y>
					<Z>12.1529055</Z>
					<R00>0.488196969</R00>
					<R01>0.164905533</R01>
					<R02>-0.857012153</R02>
					<R10>-0</R10>
					<R11>0.981986165</R11>
					<R12>0.188952908</R12>
					<R20>0.872733474</R20>
					<R21>-0.0922462344</R21>
					<R22>0.479402661</R22>
				</CoordinateFrame>
				<float name="FieldOfView">10</float>
				<CoordinateFrame name="Focus">
					<X>0.143971443</X>
					<Y>2.21904588</Y>
					<Z>0.0920257568</Z>
					<R00>1</R00>
					<R01>0</R01>
					<R02>0</R02>
					<R10>0</R10>
					<R11>1</R11>
					<R12>0</R12>
					<R20>0</R20>
					<R21>0</R21>
					<R22>1</R22>
				</CoordinateFrame>
				<string name="Name">ThumbnailCamera</string>
			</Properties>
		</Item>
	</Item>
</roblox>